# Juju hooks
hooks:
  # Set the start server flag when the start hook is triggered
  start:
    - inline-host-script: lucky kv set start_server true
    - host-script: update.sh

  # Update when config changed ( also called when starting )
  config-changed:
    # update.sh will start the proxy if it is not started
    - host-script: update.sh
  
  # Update when "domain" relation is updated
  domain-relation-changed:
    - host-script: update.sh
  domain-relation-broken:
    - host-script: update.sh
  
  # Update when leader settings change
  leader-elected:
    - host-script: update.sh
  leader-settings-changed:
    - host-script: update.sh

# Periodic jobs
cron-jobs:
  # Periodically update the HTTPS certificates
  "*/10 * * * * *":
    - container-script: update-certificates.sh
